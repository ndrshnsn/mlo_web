class i{constructor(t){this.response=t}get statusCode(){return this.response.status}get redirected(){return this.response.redirected}get ok(){return this.response.ok}get unauthenticated(){return this.statusCode===401}get unprocessableEntity(){return this.statusCode===422}get authenticationURL(){return this.response.headers.get("WWW-Authenticate")}get contentType(){return(this.response.headers.get("Content-Type")||"").replace(/;.*$/,"")}get headers(){return this.response.headers}get html(){return this.contentType.match(/^(application|text)\/(html|xhtml\+xml)$/)?this.text:Promise.reject(new Error(`Expected an HTML response but got "${this.contentType}" instead`))}get json(){return this.contentType.match(/^application\/.*json$/)?this.responseJson||(this.responseJson=this.response.json()):Promise.reject(new Error(`Expected a JSON response but got "${this.contentType}" instead`))}get text(){return this.responseText||(this.responseText=this.response.text())}get isTurboStream(){return this.contentType.match(/^text\/vnd\.turbo-stream\.html/)}async renderTurboStream(){if(this.isTurboStream)window.Turbo?await window.Turbo.renderStreamMessage(await this.text):console.warn("You must set `window.Turbo = Turbo` to automatically process Turbo Stream events with request.js");else return Promise.reject(new Error(`Expected a Turbo Stream response but got "${this.contentType}" instead`))}}class a{static register(t){this.interceptor=t}static get(){return this.interceptor}static reset(){this.interceptor=void 0}}function c(s){const t=document.cookie?document.cookie.split("; "):[],n=`${encodeURIComponent(s)}=`,e=t.find(r=>r.startsWith(n));if(e){const r=e.split("=").slice(1).join("=");if(r)return decodeURIComponent(r)}}function h(s){const t={};for(const n in s){const e=s[n];e!==void 0&&(t[n]=e)}return t}function o(s){const t=document.head.querySelector(`meta[name="${s}"]`);return t&&t.content}function u(s){return[...s].reduce((t,[n,e])=>t.concat(typeof e=="string"?[[n,e]]:[]),[])}function p(s,t){for(const[n,e]of t)e instanceof window.File||(s.has(n)&&!n.includes("[]")?(s.delete(n),s.set(n,e)):s.append(n,e))}class d{constructor(t,n,e={}){this.method=t,this.options=e,this.originalUrl=n.toString()}async perform(){try{const n=a.get();n&&await n(this)}catch(n){console.error(n)}const t=new i(await window.fetch(this.url,this.fetchOptions));return t.unauthenticated&&t.authenticationURL?Promise.reject(window.location.href=t.authenticationURL):(t.ok&&t.isTurboStream&&await t.renderTurboStream(),t)}addHeader(t,n){const e=this.additionalHeaders;e[t]=n,this.options.headers=e}sameHostname(){if(!this.originalUrl.startsWith("http:"))return!0;try{return new URL(this.originalUrl).hostname===window.location.hostname}catch{return!0}}get fetchOptions(){return{method:this.method.toUpperCase(),headers:this.headers,body:this.formattedBody,signal:this.signal,credentials:"same-origin",redirect:this.redirect}}get headers(){const t={"X-Requested-With":"XMLHttpRequest","Content-Type":this.contentType,Accept:this.accept};return this.sameHostname()&&(t["X-CSRF-Token"]=this.csrfToken),h(Object.assign(t,this.additionalHeaders))}get csrfToken(){return c(o("csrf-param"))||o("csrf-token")}get contentType(){return this.options.contentType?this.options.contentType:this.body==null||this.body instanceof window.FormData?void 0:this.body instanceof window.File?this.body.type:"application/json"}get accept(){switch(this.responseKind){case"html":return"text/html, application/xhtml+xml";case"turbo-stream":return"text/vnd.turbo-stream.html, text/html, application/xhtml+xml";case"json":return"application/json, application/vnd.api+json";default:return"*/*"}}get body(){return this.options.body}get query(){const t=(this.originalUrl.split("?")[1]||"").split("#")[0],n=new URLSearchParams(t);let e=this.options.query;e instanceof window.FormData?e=u(e):e instanceof window.URLSearchParams?e=e.entries():e=Object.entries(e||{}),p(n,e);const r=n.toString();return r.length>0?`?${r}`:""}get url(){return this.originalUrl.split("?")[0].split("#")[0]+this.query}get responseKind(){return this.options.responseKind||"html"}get signal(){return this.options.signal}get redirect(){return this.options.redirect||"follow"}get additionalHeaders(){return this.options.headers||{}}get formattedBody(){const t=Object.prototype.toString.call(this.body)==="[object String]";return this.headers["Content-Type"]==="application/json"&&!t?JSON.stringify(this.body):this.body}}export{d as F};
//# sourceMappingURL=fetch_request-Bi6ZTe2Y.js.map
